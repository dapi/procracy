# Закон 006. О банковской системе

> Уровень: Закон (60%+ голосовавших, 5 дней cooling, x2 залог)
> Статус: драфт

---

## Раздел 1. Банковская система

1.1. Директория `bank/` является единственным источником истины о балансах
     и движении средств в PRocracy.
1.2. Файл `bank/balances.json` содержит хеш вида `имя_счёта → баланс`
     для всех счетов системы.
1.3. Файл `bank/transactions.json` содержит массив всех транзакций.
     Запись ведётся в режиме append-only: существующие записи не удаляются
     и не редактируются.
1.4. Любое изменение баланса допускается только через добавление транзакции
     в `transactions.json` с одновременным обновлением `balances.json`.

## Раздел 2. Счета

2.1. **Центральные счета банка** — системные счета, не принадлежащие гражданам:
     - `emission` — эмиссионный счёт. Баланс всегда ≤ 0.
       Абсолютное значение баланса равно общему объёму эмитированных средств.
     - `treasury` — расчётный счёт государства. Принимает поступления
       от эмиссии, залоги, налоги. Баланс ≥ 0.
2.2. **Счета граждан**: ключ = github username. Баланс ≥ 0.
2.3. Счёт гражданина создаётся при принятии гражданства
     (см. Закон 005, раздел 2).

## Раздел 3. Транзакции

3.1. Каждая транзакция имеет структуру:
     ```json
     {
       "id": <целое число>,
       "date": "<ISO 8601>",
       "from": "<имя_счёта>",
       "to": "<имя_счёта>",
       "amount": <число>,
       "reason": "<описание операции>"
     }
     ```
3.2. Поля `from` и `to` — всегда строка (имя счёта), **никогда не null**.
3.3. Поле `id` строго последовательное: каждая новая транзакция получает
     `id` на единицу больше предыдущей.
3.4. Поле `amount` строго больше нуля.
3.5. Транзакция атомарна: списание у `from` и зачисление у `to`
     происходят одновременно.

## Раздел 4. Типы операций

4.1. **Эмиссия**: `emission → treasury`.
     Счёт `emission` уходит в минус, `treasury` получает средства.
     Основание: Закон 001, разделы 2–3.
4.2. **Стартовый набор**: `treasury → гражданин`.
     Основание: Закон 001, п. 2.2.
4.3. **Перевод между гражданами**: `гражданин_A → гражданин_B`.
4.4. **Залог за PR**: `гражданин → treasury`.
     Основание: Закон 002.
4.5. **Возврат залога / вознаграждение**: `treasury → гражданин`.
     Основание: Закон 002.
4.6. **Оплата госуслуг**: `гражданин → treasury`.
4.7. **Награда за issue**: `treasury → гражданин`. 10 merits за каждую закрытую
     issue при merge PR. Начисляется автоматически системой CI.

## Раздел 5. Целостность

5.1. Сумма всех балансов в `balances.json` (включая `emission`) равна нулю.
     Система замкнута: средства не создаются из ничего и не исчезают.
5.2. Ограничения балансов:
     - Счета граждан: баланс ≥ 0
     - `treasury`: баланс ≥ 0
     - `emission`: баланс ≤ 0
5.3. Любое расхождение с правилами п. 5.1–5.2 является основанием
     для аудита (раздел 6).
5.4. Изменения в директории `bank/` вносятся через PR уровня "Код"
     (см. Закон 002).

## Раздел 6. Автоматическая проверка PR

6.1. Каждый PR, изменяющий файлы в `bank/`, проходит автоматическую
     проверку (CI) до вливания.
6.2. Проверка определяет новые транзакции (id > max id в base-ветке)
     и классифицирует каждую по типу:

| Тип | from → to | Условие полномочности |
|---|---|---|
| Перевод | `гражданин → гражданин` | Автор PR == `from`, `from ≠ to` |
| Эмиссия | `emission → treasury` | PR содержит изменения в `laws/` |
| Гражданство | `treasury → новый_гражданин` | PR добавляет `citizenship/<to>.md`, amount == 100 |
| Награда за issue | `treasury → гражданин` | PR merged + закрывает issue (автокоммит CI) |

6.3. Транзакции, не попадающие ни в один тип, запрещены.
6.4. Проверка целостности PR-версии банка (раздел 5):
     - Сумма всех балансов == 0
     - `emission` ≤ 0, `treasury` ≥ 0, граждане ≥ 0
6.5. PR, не прошедший проверку, не может быть влит.

## Раздел 7. Аудит

7.1. История транзакций публична и неизменяема (append-only).
7.2. Любой гражданин может запросить аудит банковской системы.
7.3. Аудит проверяет соответствие `balances.json` истории транзакций
     и выполнение правил целостности (раздел 5).
